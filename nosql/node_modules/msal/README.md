---
ms.openlocfilehash: 4f36d4681facd228c63b48050973040e9785d30f
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 02/05/2022
ms.locfileid: "138051224"
---

<a name="microsoft-authentication-library-for-javascript-msaljs"></a>Microsoft-Authentifizierungsbibliothek für JavaScript (MSAL.js)
=========================================================

| [Erste Schritte](https://docs.microsoft.com/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa)| [AAD-Dokumentation](https://aka.ms/aaddevv2) | [Bibliotheksverweis](https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal.html) | [Unterstützung](README.md#community-help-and-support) | [Beispiele](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/Samples)
| --- | --- | --- | --- | --- |

⚠️⚠️⚠️ Diese Bibliothek erhält keine neuen Features mehr und erhält nur kritische Fehler- und Sicherheitskorrekturen. Alle neuen Anwendungen sollten stattdessen [@azure/msal-browser](https://www.npmjs.com/package/@azure/msal-browser) verwenden. ⚠️⚠️⚠️

MSAL für JavaScript ermöglicht clientseitigen JavaScript-Webanwendungen, die auf einem Webbrowser ausgeführt werden, die Authentifizierung von Benutzern über Geschäfts- Schul- oder Unikonten für [Azure AD](https://docs.microsoft.com/azure/active-directory/develop/v2-overview) (AAD), persönliche Microsoft-Konten (MSA) und Identitätsanbieter sozialer Netzwerke wie Facebook, Google, LinkedIn, Microsoft-Konten usw. über den Dienst [Azure AD B2C](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-overview#identity-providers). Es ermöglicht Ihrer App auch, Token für den Zugriff auf [Microsoft-Clouddienste](https://www.microsoft.com/enterprise) wie [Microsoft Graph](https://graph.microsoft.io) zu erhalten.

[![npm version](https://img.shields.io/npm/v/msal.svg?style=flat)](https://www.npmjs.com/package/msal)
[![npm version](https://img.shields.io/npm/dm/msal.svg)](https://nodei.co/npm/msal/)
[![codecov](https://codecov.io/gh/AzureAD/microsoft-authentication-library-for-js/branch/dev/graph/badge.svg?flag=msal-core)](https://codecov.io/gh/AzureAD/microsoft-authentication-library-for-js)

## <a name="installation"></a>Installation

### <a name="via-npm"></a>Über NPM:

    npm install msal

## <a name="via-cdn"></a>Über CDN:

<!-- CDN_LATEST -->
```html
<script type="text/javascript" src="https://alcdn.msauth.net/lib/1.4.11/js/msal.min.js"></script>
```

[Vollständige Details und bewährte Methoden](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-core/docs/cdn.md) für die CDN Nutzung sind in unserer Dokumentation verfügbar.

## <a name="what-to-expect-from-this-library"></a>Angebot in dieser Bibliothek
Die Msal-Unterstützung für Javascript ist eine Sammlung von Bibliotheken. `msal-core` oder einfach `msal` ist die framework-unabhängige Kernbibliothek. Sobald unser Kern 1.x+ stabilisiert ist, werden wir unsere `msal-angular` Bibliothek mit den neuesten Verbesserungen von 1.x bereitstellen.  Wir planen, die Unterstützung für `msal-angularjs` einzustellen, da die Nutzungstrends des Frameworks und der Bibliothek darauf hindeuten, dass Angular 2+ besser akzeptiert wird als Angular 1x. Da unsere aktuellen Bibliotheken den Standards entsprechen, werden wir damit beginnen, neue Funktionsanforderungen mit neuen Plattformen wie z. B. `react` und `node.js` abzugleichen.

Unser Ziel ist es, sehr gut mit der Community zu kommunizieren und ihre Meinungen zu berücksichtigen. Wir möchten zu einem monatlichen Minor-Release-Zeitplan gelangen, wobei Patches so oft bereitgestellt werden, wie es erforderlich ist.  Die Kommunikation, Planung und Granularität, die wir erreichen möchten, ist noch in Arbeit.

Bitte überprüfen Sie unsere [Roadmap](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki#roadmap), um zu sehen, woran wir arbeiten und was wir als Nächstes verfolgen.

## <a name="oauth-20-and-the-implicit-flow"></a>OAuth 2.0 und der implizite Flow

Msal implementiert den [Flow für die implizite Genehmigung](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-implicit-grant-flow) gemäß Definition durch das OAuth 2.0-Protokoll, und ist [OpenID-konform ](https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc).

Unser Ziel ist es, dass die Bibliothek das Protokoll so weit abstrahiert, dass eine Plug-and-Play-Authentifizierung möglich ist, aber es ist wichtig, den impliziten Ablauf aus der Sicherheitsperspektive zu kennen und zu verstehen.
Der implizite Flow läuft im Kontext eines Webbrowsers ab, der Client-Geheimnisse nicht sicher verwalten kann. Er ist für Anwendungen mit nur einer Seite optimiert und hat einen Hop weniger zwischen Client und Server, so dass die Token direkt an den Browser zurückgegeben werden. Dadurch wird er natürlich weniger sicher.
Diese Sicherheitsbedenken werden durch Standardpraktiken entschärft, z. B. durch die Verwendung von kurzlebigen Token (so dass keine Aktualisierungs-Token zurückgegeben werden), wobei die Bibliothek eine registrierte Umleitungs-URI für die Anwendung erfordert und die Anforderung und die Antwort mit einer eindeutigen Nonce und einem Statusparameter abgleicht.

## <a name="cache-storage"></a>Zwischenspeicher

Wir bieten zwei Speichermethoden für Msal, und zwar `localStorage`und `sessionStorage`.  Wir empfehlen, `sessionStorage` zu verwenden, da er sicherer ist, was die Speicherung der von den Benutzern erworbenen Token angeht, aber `localStorage` bietet Ihnen die Möglichkeit einer einmaligen Anmeldung auf allen Registerkarten und Benutzersitzungen.  Am besten prüfen Sie die Optionen und treffen so die optimale Entscheidung für Ihre Anwendung.

### <a name="forcerefresh-to-skip-cache"></a>forceRefresh zum Umgehen des Caches
Wenn Sie ein zwischengespeichertes Token überspringen und zum Server wechseln möchten, übergeben Sie den booleschen Wert `forceRefresh` in das `AuthenticationParameters`-Objekt, das zum Erstellen einer Anmelde-/Tokenanforderung verwendet wird. **WARNUNG:** Dies sollte aufgrund der Leistungsauswirkungen auf Ihre Anwendung nicht standardmäßig verwendet werden.  Wenn Sie sich auf den Cache verlassen, können Sie Ihren Nutzern eine bessere Funktionalität bieten, und der Cache sollte nur in Fällen umgangen werden, in denen Sie wissen, dass die aktuellen Daten im Cache nicht auf dem neuesten Stand sind.  Beispiel: Ein Verwaltungstool, das einem Benutzer Rollen hinzufügt, der ein neues Token mit aktualisierten Rollen benötigt.

## <a name="usage"></a>Verbrauch
Im folgenden Beispiel erfahren Sie, wie Sie einen Benutzer anmelden und ein Token erwerben, das für die Graph-API von Microsoft verwendet werden soll.

#### <a name="prerequisites"></a>Voraussetzungen

Bevor Sie MSAL.js verwenden, müssen Sie [eine Anwendung in Azure AD registrieren](https://docs.microsoft.com/azure/active-directory/develop/quickstart-register-app), um eine gültige `clientId` für die Konfiguration zu erhalten und die Routen zu registrieren, auf denen Ihre App den Umleitungsverkehr akzeptiert.

#### <a name="1-instantiate-the-useragentapplication"></a>1. Instanziieren der UserAgentApplication

`UserAgentApplication` kann mit einer Vielzahl verschiedener Optionen konfiguriert werden, die in unserem [Wiki](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL.js-1.0.0-api-release#configuration-options) detailliert beschrieben sind; der einzige erforderliche Parameter ist jedoch `auth.clientId`.

Nachdem Sie Ihre Instanz instanziiert haben, müssen Sie, wenn Sie vorhaben, einen Umleitungs-Flow in MSAL 1.2.x oder früher zu verwenden (`loginRedirect` und `acquireTokenRedirect`), mithilfe von `handleRedirectCallback(authCallback)` einen Rückruf-Handler registrieren, wobei `authCallback = function(AuthError, AuthResponse)` ist. Ab MSAL 1.3.0 ist dies optional. Die Rückruffunktion wird aufgerufen, nachdem die Authentifizierungsanforderung entweder erfolgreich oder mit einem Fehler abgeschlossen wurde. Dies ist für die Popup-Flows nicht erforderlich, da sie Zusagen zurückgeben.

```JavaScript
    import * as Msal from "msal";
    // if using cdn version, 'Msal' will be available in the global scope

    const msalConfig = {
        auth: {
            clientId: 'your_client_id'
        }
    };

    const msalInstance = new Msal.UserAgentApplication(msalConfig);

    msalInstance.handleRedirectCallback((error, response) => {
        // handle redirect response or error
    });

```

Weitere Informationen zu den Konfigurationsoptionen finden Sie unter [Initialisieren von Clientanwendungen mit MSAL.js](https://docs.microsoft.com/azure/active-directory/develop/msal-js-initializing-client-applications).

#### <a name="2-login-the-user"></a>2. Anmelden des Benutzers

Der Benutzer muss sich in Ihrer App entweder mit der `loginPopup`- oder der `loginRedirect`-Methode anmelden, um den Benutzerkontext einzurichten.

Wenn die Anmeldemethoden aufgerufen werden und die Authentifizierung des Benutzers vom Azure AD-Dienst abgeschlossen wird, wird ein [ID-Token](https://docs.microsoft.com/azure/active-directory/develop/id-tokens) zurückgegeben, das verwendet wird, um den Benutzer anhand einiger grundlegender Informationen zu identifizieren.

Wenn Sie einen Benutzer anmelden, können Sie Bereiche übergeben, denen der Benutzer bei der Anmeldung vorab zustimmen kann, dies ist jedoch nicht erforderlich. Bitte beachten Sie, dass bei der Zustimmung zu Bereichen bei der Anmeldung kein access_token für diese Bereiche zurückgegeben wird, sondern dass Sie die Möglichkeit haben, ein Token im Hintergrund unter Übergabe dieser Bereiche ohne weitere Interaktion des Benutzers zu erhalten.

Es empfiehlt sich, benötigte Bereiche nur anzufordern, wenn Sie sie benötigen. Dieses Konzept heißt dynamische Zustimmung. Auf diese Weise können Sie nicht nur eine interaktivere Zustimmung der Benutzer in Ihrer Anwendung erreichen, sondern auch die Zahl der Benutzer verringern, die sehr viele Funktionen, die sie noch nicht nutzen, nicht genehmigen möchten.

AAD ermöglicht es Ihnen lediglich, die Zustimmung für 3 Ressourcen gleichzeitig zu erhalten, obwohl Sie die Zustimmung zu vielen Bereichen innerhalb einer Ressource anfordern können.
Wenn der Benutzer eine Anmeldeanforderung erstellt, können Sie mehrere Ressourcen und ihre entsprechenden Bereiche übergeben, da AAD ein idToken ausstellt, mit dem diese Bereiche vorab genehmigt werden. AcquireToken-Aufrufe sind jedoch nur für eine Ressource / mehrere Bereiche gültig. Wenn Sie auf mehrere Ressourcen zugreifen müssen, erstellen Sie separate acquireToken-Aufrufe für jede Ressource.

```JavaScript
   var loginRequest = {
       scopes: ["user.read", "mail.send"] // optional Array<string>
   };

    msalInstance.loginPopup(loginRequest)
        .then(response => {
            // handle response
        })
        .catch(err => {
            // handle error
        });

```

##### <a name="ssosilent"></a>ssoSilent

Wenn Sie sicher sind, dass der Benutzer über eine vorhandene Sitzung verfügt und den Benutzerkontext ohne Aufforderung zur Interaktion einrichten möchte, können Sie `ssoSilent` mit einem `loginHint` oder `sid` aufrufen (verfügbar als [optionaler Aufruf](https://docs.microsoft.com/azure/active-directory/develop/active-directory-optional-claims)); daraufhin wird MSAL versuchen, SSO für die aktive Sitzung im Hintergrund durchzuführen und den Benutzerkontext einzurichten.

Beachten Sie, dass, wenn es zu dem genannten `loginHint`oder `sid` keine aktive Sitzung gibt, eine Fehlermeldung ausgegeben wird, mit der durch Aufrufen einer interaktiven Anmeldemethode (`loginPopup` oder `loginRedirect`) umgegangen werden sollte.

Beispiel:

```js
const ssoRequest = {
    loginHint: "user@example.com"
};

msalInstance.ssoSilent(ssoRequest)
    .then(response => {
        // session silently established
    })
    .catch(error => {
        // handle error by invoking an interactive login method
        msalInstance.loginPopup(ssoRequest);
    });
```

#### <a name="3-get-an-access-token-to-call-an-api"></a>3. Abrufen eines Zugriffstokens zum Aufrufen einer API

In MSAL können Sie Zugriffstoken für die APIs abrufen, die Ihre App mithilfe der `acquireTokenSilent`-Methode aufrufen muss, bei der eine Anforderung im Hintergrund an Azure AD gerichtet wird (ohne dass der Benutzer über die Benutzeroberfläche aufgefordert wird), um ein Zugriffstoken zu erhalten. Der Azure AD-Dienst gibt daraufhin ein [Zugriffstoken](https://docs.microsoft.com/azure/active-directory/develop/access-tokens) zurück, das die Bereiche enthält, denen der Benutzer zugestimmt hat, damit Ihre App die API sicher aufrufen kann.

Sie können `acquireTokenRedirect` oder `acquireTokenPopup` verwenden, um interaktive Anforderungen zu initiieren, obwohl es sich empfiehlt, nur interaktive Erfahrungen anzuzeigen, wenn Sie kein Token im Hintergrund erhalten können, weil Fehler aufgetreten sind, die eine Interaktion erforderlich machen. Wenn Sie einen interaktiven Tokenaufruf verwenden, muss er mit der Anmeldemethode übereinstimmen, die in Ihrer Anwendung verwendet wird. (`loginPopup`=> `acquireTokenPopup`, `loginRedirect` => `acquireTokenRedirect`).

Wenn der `acquireTokenSilent`-Aufruf mit einem Fehler vom Typ `InteractionRequiredAuthError` fehlschlägt, müssen Sie eine interaktive Anforderung initiieren.  Dies kann aus vielen Gründen geschehen, wie z. B. bei Bereichen, die widerrufen wurden, bei abgelaufenen Token oder bei Kennwortänderungen.

`acquireTokenSilent` sucht nach einem gültigen Token im Cache, und wenn es beinahe abgelaufen oder nicht vorhanden ist, wird automatisch versucht, es für Sie zu aktualisieren.

Weitere Informationen finden Sie unter [Anforderungs- und Antwortdatentypen](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL.js-1.0.0-api-release#signing-in-and-getting-tokens-with-msaljs).

```JavaScript
    // if the user is already logged in you can acquire a token
    if (msalInstance.getAccount()) {
        var tokenRequest = {
            scopes: ["user.read", "mail.send"]
        };
        msalInstance.acquireTokenSilent(tokenRequest)
            .then(response => {
                // get access token from response
                // response.accessToken
            })
            .catch(err => {
                // could also check if err instance of InteractionRequiredAuthError if you can import the class.
                if (err.name === "InteractionRequiredAuthError") {
                    return msalInstance.acquireTokenPopup(tokenRequest)
                        .then(response => {
                            // get access token from response
                            // response.accessToken
                        })
                        .catch(err => {
                            // handle error
                        });
                }
            });
    } else {
        // user is not logged in, you will need to log them in to acquire a token
    }
```

#### <a name="4-use-the-token-as-a-bearer-in-an-http-request-to-call-the-microsoft-graph-or-a-web-api"></a>4. Verwenden Sie das Token als Bearer in einer HTTP-Anforderung, um die Microsoft Graph- oder eine Web-API aufzurufen.

```JavaScript
    var headers = new Headers();
    var bearer = "Bearer " + token;
    headers.append("Authorization", bearer);
    var options = {
         method: "GET",
         headers: headers
    };
    var graphEndpoint = "https://graph.microsoft.com/v1.0/me";

    fetch(graphEndpoint, options)
        .then(resp => {
             //do something with response
        });
```

Sie können weitere Details zu MSAL.js-Funktionen erfahren. Diese sind im [MSAL-Wiki](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki) dokumentiert und enthalten vollständige [Codebeispiele](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/Samples).

## <a name="security-reporting"></a>Melden von Sicherheitsproblemen

Wenn Sie ein Sicherheitsproblem in unseren Bibliotheken oder Diensten feststellen, melden Sie es unter [secure@microsoft.com](mailto:secure@microsoft.com) mit so vielen Details wie möglich. Ihr Beitrag kann im Rahmen des [Microsoft Bounty](http://aka.ms/bugbounty)-Programms für eine Belohnung in Frage kommen. Melden Sie Sicherheitsprobleme nicht bei GitHub Issues oder einer anderen öffentlichen Website. Wir werden Sie in Kürze kontaktieren, sobald wir die Informationen erhalten haben. Wir empfehlen Ihnen, den Erhalt von Benachrichtigungen zu Sicherheitsvorfällen einzurichten. Rufen Sie dazu [diese Seite](https://technet.microsoft.com/security/dd252948) auf, und abonnieren Sie Sicherheitsempfehlungen.

## <a name="license"></a>Lizenz

Copyright (c) Microsoft Corporation.  Alle Rechte vorbehalten. Lizenziert unter der MIT-Lizenz (die „Lizenz“);

## <a name="we-value-and-adhere-to-the-microsoft-open-source-code-of-conduct"></a>Wir schätzen und befolgen die Microsoft-Verhaltensregeln für Open Source

Für dieses Projekt gelten die Microsoft-Verhaltensregeln für Open Source ([Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/)). Weitere Informationen finden Sie unter [Code of Conduct FAQ (FAQ zum Verhaltenskodex)](https://opensource.microsoft.com/codeofconduct/faq/). Alternativ können Sie sich mit weiteren Fragen und Kommentaren an [opencode@microsoft.com](mailto:opencode@microsoft.com) wenden.
