---
ms.openlocfilehash: 21db9b7ec97b7028a031a18867aab00575b09850
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 02/05/2022
ms.locfileid: "138053017"
---
# <a name="delayed-stream"></a>delayed-stream

Puffert Ereignisse aus einem Datenstrom, bis Sie bereit sind, sie zu verarbeiten.

## <a name="installation"></a>Installation

``` bash
npm install delayed-stream
```

## <a name="usage"></a>Verbrauch

Das folgende Beispiel zeigt, wie Sie einen HTTP-Echoserver schreiben, der seine Antwort um 1.000 ms verzögert.

``` javascript
var DelayedStream = require('delayed-stream');
var http = require('http');

http.createServer(function(req, res) {
  var delayed = DelayedStream.create(req);

  setTimeout(function() {
    res.writeHead(200);
    delayed.pipe(res);
  }, 1000);
});
```

Wenn Sie `Stream#pipe` nicht verwenden, können Sie die gepufferten Ereignisse auch manuell freigeben, indem Sie `delayedStream.resume()` aufrufen:

``` javascript
var delayed = DelayedStream.create(req);

setTimeout(function() {
  // Emit all buffered events and resume underlaying source
  delayed.resume();
}, 1000);
```

## <a name="implementation"></a>Implementierung

Damit Sie diesen Metadatenstrom richtig nutzen können, sollten Sie ein paar Dinge über die Implementierung wissen.

### <a name="event-buffering--proxying"></a>Ereignispuffer/-proxy

Alle Ereignisse des `source`-Datenstroms werden durch Überschreiben der `source.emit`-Methode übernommen. Bis node.js einen Listener zum Abfangen aller Ereignisse implementiert, ist dies die einzige Möglichkeit.

Der verzögerte Datenstrom gibt jedoch weiterhin alle Ereignisse aus, die er in `source` abfängt, unabhängig davon, ob Sie den verzögerten Datenstrom bereits freigegeben haben oder nicht.

Bei Erstellung fängt delayed-stream alle `source`-Ereignisse ab und speichert sie in einem internen Ereignispuffer. Nach Aufruf von `delayedStream.release()` werden alle gepufferten Ereignisse für `delayedStream` ausgegeben, und der Ereignispuffer wird gelöscht. Danach fungiert delayed-stream lediglich als Proxy für die zugrunde liegende Quelle.

### <a name="error-handling"></a>Fehlerbehandlung

Fehlerereignisse für `source` werden genau wie alle anderen Ereignisse gepuffert oder an einen Proxy weitergeleitet.
Allerdings fügt `delayedStream.create` an `source` einen nicht aktiven `'error'`-Listener an. Auf diese Weise müssen Sie Fehler nur für das `delayedStream`-Objekt und nicht an zwei Stellen behandeln.

### <a name="buffer-limits"></a>Puffergrenzwerte

delayed-stream bietet eine `maxDataSize`-Eigenschaft, mit der Sie die Menge der gepufferten Daten begrenzen können. Um Sie vor fehlerhaften `source`-Datenströmen zu schützen, die nicht auf `source.pause()` reagieren, ist dieses Feature standardmäßig aktiviert.

## <a name="api"></a>API

### <a name="delayedstreamcreatesource-options"></a>DelayedStream.create(source, [options])

Gibt einen neuen `delayedStream` zurück. Die verfügbaren Optionen lauten wie folgt:

* `pauseStream`
* `maxDataSize`

Die Beschreibung dieser Eigenschaften finden Sie nachstehend.

### <a name="delayedstreamsource"></a>delayedStream.source

Der von diesem Objekt verwaltete `source`-Datenstrom. Dies ist nützlich, wenn Sie Ihr `delayedStream`-Objekt weitergeben und Sie dennoch auf Eigenschaften des `source`-Objekts zugreifen möchten.

### <a name="delayedstreampausestream--true"></a>delayedStream.pauseStream = true

Gibt an, ob die zugrunde liegende `source` beim Aufruf von `DelayedStream.create()` angehalten werden soll. Eine nachträgliche Änderung dieser Eigenschaft hat keine Auswirkungen.

### <a name="delayedstreammaxdatasize--1024--1024"></a>delayedStream.maxDataSize = 1024 x 1024

Die Menge der Daten, die gepuffert werden soll, ehe `error` ausgegeben wird.

Wenn die zugrunde liegende Quelle `Buffer`-Objekte ausgibt, bezieht sich `maxDataSize` auf Bytes.

Wenn die zugrunde liegende Quelle JavaScript-Zeichenfolgen ausgibt, bezieht sich die Größe auf Zeichen.

Wenn Sie wissen, was Sie tun, können Sie diese Eigenschaft auf `Infinity` festlegen, um dieses Feature zu deaktivieren. Sie können diese Eigenschaft auch zur Laufzeit ändern.

### <a name="delayedstreamdatasize--0"></a>delayedStream.dataSize = 0

Die bisher gepufferte Datenmenge.

### <a name="delayedstreamreadable"></a>delayedStream.readable

Ein ECMA5-Getter, der den Wert von `source.readable` zurückgibt.

### <a name="delayedstreamresume"></a>delayedStream.resume()

Wenn `delayedStream` noch nicht freigegeben wurde, wird `delayedStream.release()` aufgerufen.

In beiden Fällen wird `source.resume()` aufgerufen.

### <a name="delayedstreampause"></a>delayedStream.pause()

Aufruf von `source.pause()`.

### <a name="delayedstreampipedest"></a>delayedStream.pipe(dest)

Ruft `delayedStream.resume()` auf und leitet dann die Argumente über einen Proxy an `source.pipe` weiter.

### <a name="delayedstreamrelease"></a>delayedStream.release()

Sendet und löscht alle Ereignisse, die bisher gepuffert wurden. Damit wird die zugrunde liegende Quelle nicht fortgesetzt, verwenden Sie stattdessen `delayedStream.resume()`.

## <a name="license"></a>Lizenz

delayed-stream wird unter der MIT-Lizenz lizenziert.
